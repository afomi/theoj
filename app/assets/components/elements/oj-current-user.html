<dom-module id="oj-current-user">
  <template>

    <json-get auto="" url="/api/user" handleas="json" on-core-response="isReady"></json-get>

  </template>
  <script>
    Polymer({
      is: 'oj-current-user',
      isReady: function (event) {
        var user;
        if (event.detail.response && event.detail.response.name) {
          user = event.detail.response;
          window.current_user = this.user;
          this.asyncFire('user-logged-in', user);
        } else {
          user = null;
          this.asyncFire('user-logged-out');
        }
        this.asyncFire('user', user);
      }
    });
  </script>
</dom-module>
